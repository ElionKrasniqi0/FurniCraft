@model Contact
@{
    ViewData["Title"] = "Customer Support";
}

<!-- Hero Section -->
<div class="hero">
    <div class="container">
        <div class="row justify-content-between">
            <div class="col-lg-5">
                <div class="intro-excerpt">
                    <h1>Customer Support</h1>
                    <p class="mb-4">We're here to help you with any questions or concerns about your Furni experience.</p>
                </div>
            </div>
            <div class="col-lg-7">
                <div class="hero-img-wrap">
                    <img src="~/images/support-hero.png" class="img-fluid">
                </div>
            </div>
        </div>
    </div>
</div>
<!-- End Hero Section -->

<div class="untree_co-section">
    <div class="container">
        @if (TempData["SupportMessage"] != null)
        {
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                @TempData["SupportMessage"]
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        }

        <div class="row">
            <!-- Main Content -->
            <div class="col-lg-8">
                <div class="card mb-5">
                    <div class="card-body p-5">
                        <h2 class="mb-4">How Can We Help You Today?</h2>

                        <!-- Support Topics Accordion -->
                        <div class="accordion mb-5" id="supportTopics">
                            <!-- Order Support -->
                            <div class="accordion-item mb-3 border rounded">
                                <h3 class="accordion-header" id="headingOrders">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOrders" aria-expanded="false" aria-controls="collapseOrders">
                                        <i class="fas fa-shopping-cart me-3"></i> Order Support
                                    </button>
                                </h3>
                                <div id="collapseOrders" class="accordion-collapse collapse" aria-labelledby="headingOrders" data-bs-parent="#supportTopics">
                                    <div class="accordion-body">
                                        <h4>Common Order Questions</h4>
                                        <ul class="list-unstyled">
                                            <li class="mb-3">
                                                <strong>How do I track my order?</strong>
                                                <p>Once your order ships, you'll receive a tracking number via email. You can track your package directly through the carrier's website.</p>
                                            </li>
                                            <li class="mb-3">
                                                <strong>Can I modify or cancel my order?</strong>
                                                <p>We process orders quickly to ensure fast delivery. Contact us immediately at <a href="mailto:support@furni.com">support@furni.com</a> if you need to make changes.</p>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- Returns & Exchanges -->
                            <div class="accordion-item mb-3 border rounded">
                                <h3 class="accordion-header" id="headingReturns">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseReturns" aria-expanded="false" aria-controls="collapseReturns">
                                        <i class="fas fa-exchange-alt me-3"></i> Returns & Exchanges
                                    </button>
                                </h3>
                                <div id="collapseReturns" class="accordion-collapse collapse" aria-labelledby="headingReturns" data-bs-parent="#supportTopics">
                                    <div class="accordion-body">
                                        <h4>Our Return Policy</h4>
                                        <p>We offer a 30-day return policy for most items. Items must be in original condition with all packaging materials.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Contact Form -->
                        <div class="card border-0 shadow-sm">
                            <div class="card-body p-4">
                                <h3 class="mb-4">Contact Our Support Team</h3>
                                <p>Can't find what you're looking for? Our customer care team is available to help.</p>

                                <form asp-action="Support" method="post">
                                    <div class="row mb-3">
                                        <div class="col-md-6 mb-3 mb-md-0">
                                            <label asp-for="Name" class="form-label">Full Name</label>
                                            <input asp-for="Name" type="text" class="form-control" required>
                                            <span asp-validation-for="Name" class="text-danger"></span>
                                        </div>
                                        <div class="col-md-6">
                                            <label asp-for="Email" class="form-label">Email Address</label>
                                            <input asp-for="Email" type="email" class="form-control" required>
                                            <span asp-validation-for="Email" class="text-danger"></span>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label asp-for="Subject" class="form-label">Subject</label>
                                        <input asp-for="Subject" type="text" class="form-control" required>
                                        <span asp-validation-for="Subject" class="text-danger"></span>
                                    </div>
                                    <div class="mb-3">
                                        <label asp-for="Message" class="form-label">Message</label>
                                        <textarea asp-for="Message" class="form-control" rows="5" required></textarea>
                                        <span asp-validation-for="Message" class="text-danger"></span>
                                    </div>
                                    <button type="submit" class="btn btn-primary">Submit Request</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4">
                <!-- Replace the Live Chat Support card in Support.cshtml with this: -->
                <div class="card mb-4">
                    <div class="card-body text-center p-4">
                        <div class="icon-large text-primary mb-3">
                            <i class="fas fa-headset"></i>
                        </div>
                        <h3>Live Chat Support</h3>
                        <p class="mb-4">Get immediate assistance from our support team.</p>
                        <button id="startLiveChat" class="btn btn-primary w-100 mb-2">
                            Start Live Chat
                        </button>
                        <div id="chatStatus" class="small text-muted"></div>

                        <!-- Chat container (hidden by default) -->
                        <div id="chatContainer" class="mt-3 d-none">
                            <div id="chatMessages" class="border rounded p-3 mb-2" style="height: 200px; overflow-y: auto;"></div>
                            <div class="input-group">
                                <input type="text" id="chatInput" class="form-control" placeholder="Type your message...">
                                <button id="sendMessage" class="btn btn-primary">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                            <button id="endChat" class="btn btn-danger btn-sm mt-2 w-100">End Chat</button>
                        </div>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-body p-4">
                        <h4 class="mb-3">Contact Information</h4>
                        <ul class="list-unstyled">
                            <li class="mb-3">
                                <i class="fas fa-phone-alt me-2 text-primary"></i>
                                <strong>Phone:</strong> +(383) 045 804 555
                            </li>
                            <li class="mb-3">
                                <i class="fas fa-envelope me-2 text-primary"></i>
                                <strong>Email:</strong> support@furni.com
                            </li>
                            <li class="mb-3">
                                <i class="fas fa-map-marker-alt me-2 text-primary"></i>
                                <strong>Address:</strong> Meto Bajraktari, Prishtina
                            </li>
                        </ul>
                        <hr>
                        <h5 class="mt-4">Business Hours</h5>
                        <ul class="list-unstyled">
                            <li>Monday-Friday: 9:00 AM - 6:00 PM</li>
                            <li>Saturday: 10:00 AM - 4:00 PM</li>
                            <li>Sunday: Closed</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <div class="card-body p-4">
                        <h4 class="mb-3">Helpful Resources</h4>
                        <div class="list-group">
                            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                Shipping Information
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                Return Policy
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                Warranty Information
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                Payment Options
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                Size Guides
                                <i class="fas fa-chevron-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Support Guarantee Section -->
<div class="py-5 bg-light">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center">
                <div class="icon-large text-primary mb-3">
                    <i class="fas fa-medal"></i>
                </div>
                <h2 class="mb-3">Our Customer Support Guarantee</h2>
                <p class="lead mb-4">At Furni, we're committed to providing exceptional customer service. Here's our promise to you:</p>

                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="h-100 p-4 bg-white rounded shadow-sm text-center">
                            <div class="icon-medium text-primary mb-3">
                                <i class="fas fa-clock"></i>
                            </div>
                            <h5>24-Hour Response</h5>
                            <p class="mb-0">We respond to all inquiries within one business day</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="h-100 p-4 bg-white rounded shadow-sm text-center">
                            <div class="icon-medium text-primary mb-3">
                                <i class="fas fa-user-tie"></i>
                            </div>
                            <h5>Expert Assistance</h5>
                            <p class="mb-0">Knowledgeable staff trained in furniture and design</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="h-100 p-4 bg-white rounded shadow-sm text-center">
                            <div class="icon-medium text-primary mb-3">
                                <i class="fas fa-heart"></i>
                            </div>
                            <h5>Satisfaction Guaranteed</h5>
                            <p class="mb-0">We'll work until you're completely satisfied</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
                // Start live chat
        $('#startLiveChat').click(function() {
            $(this).addClass('d-none');
            $('#chatContainer').removeClass('d-none');
            $('#chatMessages').append('<div class="text-muted small">Connecting to support agent...</div>');

            $.post('/Home/StartChatSession', function(response) {
                if (response.success) {
                    $('#chatMessages').append('<div class="text-end mb-2"><span class="badge bg-primary">Support Agent</span><div class="bg-light p-2 rounded d-inline-block">Hello! How can I help you today?</div></div>');
                    $('#chatMessages').scrollTop($('#chatMessages')[0].scrollHeight);
                }
            });
        });

        function sendMessage() {
            const message = $('#chatInput').val().trim();
            if (message) {
                // Add user message
                $('#chatMessages').append('<div class="text-start mb-2"><span class="badge bg-secondary">You</span><div class="bg-primary text-white p-2 rounded d-inline-block">' + message + '</div></div>');
                $('#chatInput').val('');

                $.post('/Home/SendChatMessage', {
                    sessionId: 'current-session-id', // You would store this from StartChatSession
                    message: message
                }, function(response) {
                    if (response.success) {
                        // This would ideally come from a SignalR connection in a real app
                        $('#chatMessages').append('<div class="text-end mb-2"><span class="badge bg-primary">Support Agent</span><div class="bg-light p-2 rounded d-inline-block">Thanks for your message. Let me check that for you.</div></div>');
                        $('#chatMessages').scrollTop($('#chatMessages')[0].scrollHeight);
                    }
                });

                $('#chatMessages').scrollTop($('#chatMessages')[0].scrollHeight);
            }
        }

        // End chat
        $('#endChat').click(function() {
            $.post('/Home/EndChatSession', {
                sessionId: 'current-session-id'
            }, function(response) {
                if (response.success) {
                    $('#chatMessages').append('<div class="text-muted small">Chat ended. Thank you for contacting us!</div>');
                    $('#chatContainer').addClass('d-none');
                    $('#startLiveChat').removeClass('d-none');
                }
            });
        });
    </script>
}